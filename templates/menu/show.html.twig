{% extends 'base.html.twig' %}

{% block title %}{{ menu.name }} - Vite & Gourmand{% endblock %}

{% block body %}
<div style="min-height: 100vh; background: linear-gradient(135deg, #e0f2fe 0%, #dcfce7 100%);">
    <div style="max-width: 900px; margin: 0 auto; padding: 2rem;">

        <a href="{{ path('app_menu') }}" style="color: var(--primary-color); display: inline-flex; align-items: center; gap: 0.5rem; margin-bottom: 2rem; font-weight: 600;">
            ‚Üê Retour au menu
        </a>

        <div class="glass" style="padding: 2.5rem; border-radius: 1.5rem;">
            <div style="display: flex; justify-content: space-between; align-items: flex-start; flex-wrap: wrap; gap: 1rem;">
                <div>
                    <h1 style="font-size: 2.5rem; color: var(--dark-bg); margin-bottom: 0.5rem;">{{ menu.name }}</h1>
                    {% if menu.description %}
                        <p style="color: #6B7280; font-size: 1.1rem; max-width: 600px;">{{ menu.description }}</p>
                    {% endif %}
                </div>
                <div style="text-align: right;">
                    <div style="font-size: 2rem; font-weight: bold; color: var(--secondary-color);">{{ menu.price }} ‚Ç¨</div>
                    <div style="color: #6B7280; font-size: 0.9rem;">par personne</div>
                </div>
            </div>

            <div style="display: flex; gap: 2rem; margin: 2rem 0; flex-wrap: wrap;">
                {% if menu.minPeople %}
                <div style="background: rgba(16,185,129,0.1); border: 1px solid rgba(16,185,129,0.3); border-radius: 0.75rem; padding: 1rem 1.5rem; text-align: center;">
                    <div style="font-size: 1.5rem; font-weight: bold; color: var(--primary-color);">{{ menu.minPeople }}</div>
                    <div style="font-size: 0.85rem; color: #6B7280;">personnes minimum</div>
                </div>
                {% endif %}
                {% if menu.stock is not null %}
                <div style="background: {% if menu.stock > 5 %}rgba(16,185,129,0.1){% elseif menu.stock > 0 %}rgba(249,115,22,0.1){% else %}rgba(239,68,68,0.1){% endif %}; border: 1px solid {% if menu.stock > 5 %}rgba(16,185,129,0.3){% elseif menu.stock > 0 %}rgba(249,115,22,0.3){% else %}rgba(239,68,68,0.3){% endif %}; border-radius: 0.75rem; padding: 1rem 1.5rem; text-align: center;">
                    <div style="font-size: 1.5rem; font-weight: bold; color: {% if menu.stock > 5 %}var(--primary-color){% elseif menu.stock > 0 %}var(--secondary-color){% else %}#EF4444{% endif %};">
                        {% if menu.stock > 0 %}{{ menu.stock }}{% else %}√âpuis√©{% endif %}
                    </div>
                    <div style="font-size: 0.85rem; color: #6B7280;">{% if menu.stock > 0 %}disponibles{% endif %}</div>
                </div>
                {% endif %}
            </div>

            <hr style="border: none; border-top: 1px solid rgba(0,0,0,0.1); margin: 2rem 0;">

            <h2 style="font-size: 1.5rem; margin-bottom: 1.5rem;">Composition du menu</h2>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">
                {% for product in menu.products %}
                <div style="background: rgba(255,255,255,0.6); border: 1px solid rgba(255,255,255,0.5); border-radius: 1rem; padding: 1.25rem;">
                    <div style="font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.1em; color: var(--primary-color); font-weight: 600; margin-bottom: 0.25rem;">
                        {{ product.category|capitalize }}
                    </div>
                    <div style="font-weight: 700; font-size: 1.1rem; margin-bottom: 0.5rem;">{{ product.name }}</div>
                    {% if product.description %}
                        <div style="color: #6B7280; font-size: 0.9rem;">{{ product.description }}</div>
                    {% endif %}
                    {% if product.diets|length > 0 %}
                    <div style="margin-top: 0.75rem; display: flex; gap: 0.25rem; flex-wrap: wrap;">
                        {% for diet in product.diets %}
                            <span style="background: rgba(16,185,129,0.15); color: var(--primary-color); font-size: 0.7rem; padding: 0.15rem 0.5rem; border-radius: 999px; font-weight: 600;">üåø {{ diet.name }}</span>
                        {% endfor %}
                    </div>
                    {% endif %}
                    {% if product.allergens|length > 0 %}
                    <div style="margin-top: 0.5rem; display: flex; gap: 0.25rem; flex-wrap: wrap;">
                        {% for allergen in product.allergens %}
                            <span style="background: rgba(249,115,22,0.15); color: var(--secondary-color); font-size: 0.7rem; padding: 0.15rem 0.5rem; border-radius: 999px; font-weight: 600;">‚ö†Ô∏è {{ allergen.name }}</span>
                        {% endfor %}
                    </div>
                    {% endif %}
                </div>
                {% endfor %}
            </div>

            <div style="margin-top: 3rem; text-align: center;">
                {% if menu.stock is not null and menu.stock <= 0 %}
                    <button class="btn" style="background: #9CA3AF; color: white; cursor: not-allowed; padding: 1rem 3rem; font-size: 1.1rem;" disabled>
                        Menu √©puis√©
                    </button>
                {% elseif app.user %}
                    <a href="{{ path('order_create', {'menuId': menu.id}) }}" class="btn btn-primary" style="padding: 1rem 3rem; font-size: 1.1rem;">
                        üõí Commander ce menu
                    </a>
                {% else %}
                    <p style="margin-bottom:1rem;color:#6b7280;">Vous devez √™tre connect√© pour commander.</p>
                    <a href="{{ path('app_login') }}" class="btn btn-primary" style="padding: 1rem 3rem; font-size: 1.1rem;">
                        Connectez-vous pour commander
                    </a>
                    <a href="{{ path('app_register') }}" class="btn" style="padding: 1rem 2rem; font-size: 1rem; margin-left:0.5rem; border:1px solid var(--primary-color); color:var(--primary-color);">
                        Cr√©er un compte
                    </a>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}
