{% extends 'base.html.twig' %}
{% block title %}Administration — Menus{% endblock %}
{% block body %}
<div style="max-width:1100px;margin:2rem auto;padding:0 1rem;">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem;">
        <h1 style="font-size:1.8rem;font-weight:700;"><i class="fa-solid fa-utensils"></i> Gestion des Menus</h1>
        <div style="display:flex;gap:0.75rem;">
            <a href="{{ path('admin_product_index') }}" class="btn" style="background:rgba(99,102,241,0.15);color:#6366f1;border:1px solid rgba(99,102,241,0.3);padding:0.5rem 1rem;border-radius:0.5rem;text-decoration:none;"><i class="fa-solid fa-carrot"></i> Plats</a>
            <a href="{{ path('admin_horaire_index') }}" class="btn" style="background:rgba(99,102,241,0.15);color:#6366f1;border:1px solid rgba(99,102,241,0.3);padding:0.5rem 1rem;border-radius:0.5rem;text-decoration:none;"><i class="fa-regular fa-clock"></i> Horaires</a>
            <a href="{{ path('admin_order_index') }}" class="btn" style="background:rgba(99,102,241,0.15);color:#6366f1;border:1px solid rgba(99,102,241,0.3);padding:0.5rem 1rem;border-radius:0.5rem;text-decoration:none;"><i class="fa-solid fa-box"></i> Commandes</a>
            <a href="{{ path('admin_review_index') }}" class="btn" style="background:rgba(99,102,241,0.15);color:#6366f1;border:1px solid rgba(99,102,241,0.3);padding:0.5rem 1rem;border-radius:0.5rem;text-decoration:none;"><i class="fa-solid fa-star"></i> Avis</a>
            <a href="{{ path('admin_menu_new') }}" class="btn btn-primary" style="padding:0.5rem 1rem;">+ Nouveau menu</a>
        </div>
    </div>

    {% for flash in app.flashes('success') %}
        <div style="background:rgba(16,185,129,0.15);border:1px solid rgba(16,185,129,0.4);color:#065F46;border-radius:0.5rem;padding:1rem;margin-bottom:1rem;"><i class="fa-solid fa-check"></i> {{ flash }}</div>
    {% endfor %}

    <div style="background:white;border-radius:1rem;box-shadow:0 2px 12px rgba(0,0,0,0.08);overflow:hidden;">
        <table style="width:100%;border-collapse:collapse;">
            <thead>
                <tr style="background:#f9fafb;border-bottom:2px solid #e5e7eb;">
                    <th style="padding:1rem;text-align:left;">Titre</th>
                    <th style="padding:1rem;text-align:left;">Prix</th>
                    <th style="padding:1rem;text-align:left;">Min. personnes</th>
                    <th style="padding:1rem;text-align:left;">Stock</th>
                    <th style="padding:1rem;text-align:left;">Plats</th>
                    <th style="padding:1rem;text-align:center;">Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for menu in menus %}
                <tr style="border-bottom:1px solid #f3f4f6;">
                    <td style="padding:1rem;font-weight:600;">{{ menu.name }}</td>
                    <td style="padding:1rem;color:var(--secondary-color);font-weight:700;">{{ menu.price }} €</td>
                    <td style="padding:1rem;">{{ menu.minPeople ?? '—' }} pers.</td>
                    <td style="padding:1rem;">
                        {% if menu.stock is not null %}
                            <span style="color:{% if menu.stock > 0 %}var(--primary-color){% else %}#ef4444{% endif %};">{{ menu.stock }}</span>
                        {% else %}—{% endif %}
                    </td>
                    <td style="padding:1rem;font-size:0.85rem;color:#6b7280;">{{ menu.products|length }} plat(s)</td>
                    <td style="padding:1rem;text-align:center;display:flex;gap:0.5rem;justify-content:center;">
                        <a href="{{ path('admin_menu_edit', {id: menu.id}) }}" style="background:rgba(99,102,241,0.1);color:#6366f1;padding:0.4rem 0.8rem;border-radius:0.4rem;text-decoration:none;font-size:0.85rem;"><i class="fa-solid fa-pen"></i> Modifier</a>
                        <form method="post" action="{{ path('admin_menu_delete', {id: menu.id}) }}" onsubmit="return confirm('Supprimer ce menu ?')">
                            <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ menu.id) }}">
                            <button type="submit" style="background:rgba(239,68,68,0.1);color:#ef4444;padding:0.4rem 0.8rem;border-radius:0.4rem;border:none;cursor:pointer;font-size:0.85rem;"><i class="fa-solid fa-trash"></i> Supprimer</button>
                        </form>
                    </td>
                </tr>
                {% else %}
                <tr><td colspan="6" style="padding:2rem;text-align:center;color:#9ca3af;">Aucun menu pour l'instant.</td></tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}
