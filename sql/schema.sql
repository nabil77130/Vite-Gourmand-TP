CREATE TABLE doctrine_migration_versions (version VARCHAR(191) NOT NULL, executed_at DATETIME DEFAULT NULL, execution_time INTEGER DEFAULT NULL, PRIMARY KEY (version));
CREATE TABLE IF NOT EXISTS "order" (id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, created_at DATETIME NOT NULL, status VARCHAR(20) NOT NULL, total_price DOUBLE PRECISION NOT NULL, user_id INTEGER NOT NULL, delivery_time TIME DEFAULT NULL, event_date DATE DEFAULT NULL, equipment_loan BOOLEAN DEFAULT NULL, equipment_return BOOLEAN DEFAULT NULL, nombre_personne INTEGER DEFAULT NULL, prix_livraison DOUBLE PRECISION DEFAULT NULL, cancellation_reason CLOB DEFAULT NULL, adresse_prestation VARCHAR(255) DEFAULT NULL, CONSTRAINT FK_F5299398A76ED395 FOREIGN KEY (user_id) REFERENCES user (id) NOT DEFERRABLE INITIALLY IMMEDIATE);
CREATE TABLE sqlite_sequence(name,seq);
CREATE INDEX IDX_F5299398A76ED395 ON "order" (user_id);
CREATE TABLE product (id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, name VARCHAR(255) NOT NULL, description CLOB DEFAULT NULL, price DOUBLE PRECISION NOT NULL, image_name VARCHAR(255) DEFAULT NULL, is_available BOOLEAN NOT NULL, category VARCHAR(20) NOT NULL);
CREATE TABLE user (id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, email VARCHAR(180) NOT NULL, roles CLOB NOT NULL, password VARCHAR(255) NOT NULL, first_name VARCHAR(50) NOT NULL, last_name VARCHAR(50) NOT NULL, address VARCHAR(255) DEFAULT NULL, city VARCHAR(100) DEFAULT NULL, zip_code VARCHAR(20) DEFAULT NULL, phone VARCHAR(20) DEFAULT NULL, pays VARCHAR(100) DEFAULT NULL);
CREATE UNIQUE INDEX UNIQ_IDENTIFIER_EMAIL ON user (email);
CREATE TABLE messenger_messages (id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, body CLOB NOT NULL, headers CLOB NOT NULL, queue_name VARCHAR(190) NOT NULL, created_at DATETIME NOT NULL, available_at DATETIME NOT NULL, delivered_at DATETIME DEFAULT NULL);
CREATE INDEX IDX_75EA56E0FB7336F0E3BD61CE16BA31DBBF396750 ON messenger_messages (queue_name, available_at, delivered_at, id);
CREATE TABLE allergen (id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, name VARCHAR(255) NOT NULL);
CREATE TABLE diet (id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, name VARCHAR(255) NOT NULL);
CREATE TABLE menu (id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, name VARCHAR(255) NOT NULL, description CLOB DEFAULT NULL, price NUMERIC(10, 2) NOT NULL, min_people INTEGER DEFAULT NULL, stock INTEGER DEFAULT NULL);
CREATE TABLE menu_product (menu_id INTEGER NOT NULL, product_id INTEGER NOT NULL, PRIMARY KEY (menu_id, product_id), CONSTRAINT FK_5B911913CCD7E912 FOREIGN KEY (menu_id) REFERENCES menu (id) ON DELETE CASCADE NOT DEFERRABLE INITIALLY IMMEDIATE, CONSTRAINT FK_5B9119134584665A FOREIGN KEY (product_id) REFERENCES product (id) ON DELETE CASCADE NOT DEFERRABLE INITIALLY IMMEDIATE);
CREATE INDEX IDX_5B911913CCD7E912 ON menu_product (menu_id);
CREATE INDEX IDX_5B9119134584665A ON menu_product (product_id);
CREATE TABLE product_allergen (product_id INTEGER NOT NULL, allergen_id INTEGER NOT NULL, PRIMARY KEY (product_id, allergen_id), CONSTRAINT FK_EE0F62594584665A FOREIGN KEY (product_id) REFERENCES product (id) ON DELETE CASCADE NOT DEFERRABLE INITIALLY IMMEDIATE, CONSTRAINT FK_EE0F62596E775A4A FOREIGN KEY (allergen_id) REFERENCES allergen (id) ON DELETE CASCADE NOT DEFERRABLE INITIALLY IMMEDIATE);
CREATE INDEX IDX_EE0F62594584665A ON product_allergen (product_id);
CREATE INDEX IDX_EE0F62596E775A4A ON product_allergen (allergen_id);
CREATE TABLE product_diet (product_id INTEGER NOT NULL, diet_id INTEGER NOT NULL, PRIMARY KEY (product_id, diet_id), CONSTRAINT FK_100C47814584665A FOREIGN KEY (product_id) REFERENCES product (id) ON DELETE CASCADE NOT DEFERRABLE INITIALLY IMMEDIATE, CONSTRAINT FK_100C4781E1E13ACE FOREIGN KEY (diet_id) REFERENCES diet (id) ON DELETE CASCADE NOT DEFERRABLE INITIALLY IMMEDIATE);
CREATE INDEX IDX_100C47814584665A ON product_diet (product_id);
CREATE INDEX IDX_100C4781E1E13ACE ON product_diet (diet_id);
CREATE TABLE product_theme (product_id INTEGER NOT NULL, theme_id INTEGER NOT NULL, PRIMARY KEY (product_id, theme_id), CONSTRAINT FK_36299C544584665A FOREIGN KEY (product_id) REFERENCES product (id) ON DELETE CASCADE NOT DEFERRABLE INITIALLY IMMEDIATE, CONSTRAINT FK_36299C5459027487 FOREIGN KEY (theme_id) REFERENCES theme (id) ON DELETE CASCADE NOT DEFERRABLE INITIALLY IMMEDIATE);
CREATE INDEX IDX_36299C544584665A ON product_theme (product_id);
CREATE INDEX IDX_36299C5459027487 ON product_theme (theme_id);
CREATE TABLE theme (id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, name VARCHAR(255) NOT NULL);
CREATE TABLE horaire (id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, jour VARCHAR(20) NOT NULL, heure_ouverture VARCHAR(10) DEFAULT NULL, heure_fermeture VARCHAR(10) DEFAULT NULL, ferme BOOLEAN NOT NULL);
CREATE TABLE order_item (id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, quantity INTEGER NOT NULL, price_at_order DOUBLE PRECISION NOT NULL, order_ref_id INTEGER NOT NULL, product_id INTEGER DEFAULT NULL, menu_id INTEGER DEFAULT NULL, CONSTRAINT FK_52EA1F09E238517C FOREIGN KEY (order_ref_id) REFERENCES "order" (id) ON UPDATE NO ACTION ON DELETE NO ACTION NOT DEFERRABLE INITIALLY IMMEDIATE, CONSTRAINT FK_52EA1F094584665A FOREIGN KEY (product_id) REFERENCES product (id) ON UPDATE NO ACTION ON DELETE NO ACTION NOT DEFERRABLE INITIALLY IMMEDIATE, CONSTRAINT FK_52EA1F09CCD7E912 FOREIGN KEY (menu_id) REFERENCES menu (id) NOT DEFERRABLE INITIALLY IMMEDIATE);
CREATE INDEX IDX_52EA1F094584665A ON order_item (product_id);
CREATE INDEX IDX_52EA1F09E238517C ON order_item (order_ref_id);
CREATE INDEX IDX_52EA1F09CCD7E912 ON order_item (menu_id);
CREATE TABLE review (id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, rating INTEGER NOT NULL, comment CLOB DEFAULT NULL, order_ref_id INTEGER NOT NULL, status VARCHAR(20) NOT NULL, CONSTRAINT FK_794381C6E238517C FOREIGN KEY (order_ref_id) REFERENCES "order" (id) ON UPDATE NO ACTION ON DELETE NO ACTION NOT DEFERRABLE INITIALLY IMMEDIATE);
CREATE UNIQUE INDEX UNIQ_794381C6E238517C ON review (order_ref_id);
